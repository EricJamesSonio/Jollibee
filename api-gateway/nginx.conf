server {
    listen 80;

    # Enable CORS
    add_header 'Access-Control-Allow-Origin' '*' always;
    add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS' always;
    add_header 'Access-Control-Allow-Headers' 'Origin, Content-Type, Accept, Authorization' always;

    # Handle preflight requests
    if ($request_method = OPTIONS) {
        return 204;
    }

    # Menu Service API
    location /menu/ {
        proxy_pass http://menu-service:3001/api/;
    }

    # Menu Service images
    location /images/ {
        proxy_pass http://menu-service:3001/images/;
    }

    # Cart Service API
    location /cart/ {
        proxy_pass http://cart-service:3002/api/;
    }

    # Order Service API
    location /orders/ {
        proxy_pass http://order-service:3003/api/;
    }

    # Payment Service API
    location /payments/ {
        proxy_pass http://payment-service:3004/api/;
    }
}

http {
    server {
        listen 80;

        # Enable CORS for all routes
        add_header 'Access-Control-Allow-Origin' '*' always;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Origin, Content-Type, Accept, Authorization' always;

        # Handle preflight requests
        if ($request_method = OPTIONS) {
            return 204;
        }

        # Menu Service
        location /menu/ {
            proxy_pass http://menu-service:3001/;
        }

        # Cart Service
        location /cart/ {
            proxy_pass http://cart-service:3002/;
        }

        # Order Service
        location /orders/ {
            proxy_pass http://order-service:3003/;
        }

        # Payment Service
        location /payments/ {
            proxy_pass http://payment-service:3004/;
        }
    }
}
